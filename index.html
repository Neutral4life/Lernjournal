<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini Calendar</title>
<style>
  :root { --gap: .5rem; --radius: 14px; --shadow: 0 6px 18px rgba(0,0,0,.08); }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#f6f7fb; margin:0; padding:2rem; display:grid; place-items:center; }
  .cal { width:min(720px, 95vw); background:#fff; border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; }
  .cal__header { display:flex; align-items:center; justify-content:space-between; padding:1rem 1.25rem; border-bottom:1px solid #eee; }
  .cal__title { font-size:1.1rem; font-weight:700; letter-spacing:.2px; }
  .cal__controls { display:flex; gap:.5rem; align-items:center; }
  button { border:1px solid #ddd; background:#fff; padding:.45rem .7rem; border-radius:10px; cursor:pointer; }
  button:hover { background:#f3f4f7; }
  .today-btn { font-weight:600; }
  .grid { display:grid; grid-template-columns: repeat(7, 1fr); gap:var(--gap); padding:1rem; }
  .dow { text-align:center; font-size:.85rem; font-weight:700; color:#6a6f7a; padding:.4rem 0; }
  .cell { aspect-ratio: 1 / 1; padding:.6rem; border-radius:12px; display:flex; align-items:flex-start; justify-content:flex-start; position:relative; border:1px solid #eee; background:#fff; }
  .cell.muted { color:#9aa1ac; background:#fafbfc; }
  .cell.today { border-color:#4c8bf5; box-shadow: inset 0 0 0 2px #4c8bf5; }
  .date { font-weight:600; }
  .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
  @media (max-width:480px){
    .date { font-size:.95rem; }
    .cal__title { font-size:1rem; }
  }
</style>
</head>
<body>
    <a href="page.html?date=2025-08-28" class="date-link">28</a>
  <div class="cal" aria-label="Calendar">
    <div class="cal__header">
      <div class="cal__title" id="calTitle">Month YYYY</div>
      <div class="cal__controls" aria-label="Calendar controls">
        <button id="prevBtn" aria-label="Previous month">←</button>
        <button id="todayBtn" class="today-btn">Today</button>
        <button id="nextBtn" aria-label="Next month">→</button>
      </div>
    </div>
    <div class="grid" id="dow" aria-hidden="true"></div>
    <div class="grid" id="grid" role="grid" aria-labelledby="calTitle"></div>
  </div>

<script>
(() => {
  const dowNames = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]; // ISO week
  const dow = document.getElementById('dow');
  const grid = document.getElementById('grid');
  const title = document.getElementById('calTitle');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const todayBtn = document.getElementById('todayBtn');

  // Render DOW header
  dow.innerHTML = dowNames.map(d => `<div class="dow">${d}</div>`).join('');

  let view = (d => new Date(d.getFullYear(), d.getMonth(), 1))(new Date());
  const realToday = new Date(); realToday.setHours(0,0,0,0);

  function daysInMonth(y,m){ return new Date(y, m+1, 0).getDate(); }
  function isoWeekdayIndex(date){ // 0..6 starting Monday
    let n = date.getDay(); // 0..6 Sun..Sat
    return (n + 6) % 7;
  }

  function render(){
    const year = view.getFullYear();
    const month = view.getMonth();
    title.textContent = view.toLocaleDateString(undefined, { month: 'long', year: 'numeric' });

    // Calculate leading and trailing days to fill 6 weeks (42 cells)
    const firstDow = isoWeekdayIndex(new Date(year, month, 1));
    const dim = daysInMonth(year, month);
    const prevDim = daysInMonth(year, month-1);
    const totalCells = 42;

    const cells = [];

    // leading from previous month
    for (let i = firstDow; i > 0; i--) {
      const dayNum = prevDim - i + 1;
      const d = new Date(year, month-1, dayNum);
      cells.push(cellHTML(d, true));
    }
    // current month
    for (let day=1; day<=dim; day++) {
      const d = new Date(year, month, day);
      cells.push(cellHTML(d, false));
    }
    // trailing from next month
    while (cells.length < totalCells) {
      const dayNum = cells.length - (firstDow + dim) + 1;
      const d = new Date(year, month+1, dayNum);
      cells.push(cellHTML(d, true));
    }

    grid.innerHTML = cells.join('');
  }
  
  function sameDate(a,b){ return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }
function cellHTML(dateObj, muted){
  const isToday = sameDate(dateObj, realToday);
  const classes = ['cell'];
  if (muted) classes.push('muted');
  if (isToday) classes.push('today');
  
  const dateStr = dateObj.toISOString().split('T')[0]; // YYYY-MM-DD

  return `
    <a href="day.html?date=${dateStr}" 
       class="${classes.join(' ')}" 
       role="gridcell" 
       aria-selected="${isToday ? 'true' : 'false'}">
      <span class="date">${dateObj.getDate()}</span>
      <span class="sr-only">${dateObj.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</span>
    </a>`;
}
  function cellHTML(dateObj, muted){
    const isToday = sameDate(dateObj, realToday);
    const classes = ['cell'];
    if (muted) classes.push('muted');
    if (isToday) classes.push('today');
    return `
      <div class="${classes.join(' ')}" role="gridcell" aria-selected="${isToday ? 'true' : 'false'}" data-date="${dateObj.toISOString()}">
        <span class="date" aria-hidden="true">${dateObj.getDate()}</span>
        <span class="sr-only">${dateObj.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'long', day:'numeric' })}</span>
      </div>`;
  }

  prevBtn.addEventListener('click', () => { view = new Date(view.getFullYear(), view.getMonth()-1, 1); render(); });
  nextBtn.addEventListener('click', () => { view = new Date(view.getFullYear(), view.getMonth()+1, 1); render(); });
  todayBtn.addEventListener('click', () => { view = new Date(realToday.getFullYear(), realToday.getMonth(), 1); render(); });

  render();
})();
</script>
</body>
</html>